{"version":3,"file":"react_goods-min_js.bundle.js","mappings":"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AAC,QAAQ;QAAC,KAAK,EAAE;UAACoB,KAAK,EAAE;QAAO;MAAE,gBAAC;QAAI,SAAS,EAAC;MAAY,GAAE,IAAI,CAACnD,KAAK,CAACgC,IAAI,CAACH,MAAM,GAAG,EAAE,GAAG,IAAI,CAAC7B,KAAK,CAACgC,IAAI,CAACoB,SAAS,CAAC,CAAC,EAAE,EAAE,CAAC,GAAG,KAAK,GAAG,IAAI,CAACpD,KAAK,CAACgC,IAAI,CAAM,CAAI,eAC3M;QAAG,SAAS,EAAC;MAAW,GAAE,IAAI,CAAChC,KAAK,CAACkC,KAAK,GAAG,GAAG,CAAK,eACrD;QAAG,SAAS,EAAC;MAAW,gBAAC;QAAO,SAAS,EAAC;MAAY,GAAEO,OAAO,CAAS,CAAI,CACtE,CACD,CACD,CACA,CACF;IAET;EAAC;EAAA;AAAA,EA1DiB3C,wDAAe;AA6DlC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEC;AACD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEC;AACD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","sources":["webpack://fartza.ru/./react/goods-min.js"],"sourcesContent":["import React from 'react';\r\n\r\nexport default class GoodsMin extends React.Component {\r\n\tconstructor(props) {\r\n\t\tsuper(props);\r\n\t\tthis.state = { goods: 0 };\r\n\t\tthis.getNew = this.getNew.bind(this);\r\n\t\tthis.getPopular = this.getPopular.bind(this);\r\n\t\tif (!window.location.href.match(\"search=true\")) {\r\n\t\t\tif (window.location.href.match(\"sort=new\") || !window.location.href.match(\"sort\")) {\r\n\t\t\t\tthis.getNew();\r\n\t\t\t}\r\n\t\t\telse if (window.location.href.match(\"sort=popular\")) {\r\n\t\t\t\tthis.getPopular();\r\n\t\t\t}\r\n\t\t}\r\n\t\tconst subscriptionChangeState = this.props.emitter.subscribe(\"CHANGE\", (state) => this.setState({ goods: state }));\r\n\t}\r\n\r\n\tgetNew() {\r\n\t\t/*const data = new FormData();\r\n\t\tdata.append('command', 'getGoods');\r\n\t\tdata.append('since', 0);*/\r\n\t\tfetch('/api', {\r\n\t\t\tmethod: 'POST',\r\n\t\t    headers: {\r\n\t\t      'Accept': 'application/json',\r\n\t\t      'Content-Type': 'application/json'\r\n\t\t    },\r\n\t\t    body: JSON.stringify({command: 'getNew', since: 0})\r\n\t\t}).then(response => {\r\n\t\t\tresponse.json().then(body => {\r\n\t\t\t\tthis.setState({ goods: body.goods[0] });\r\n\t\t\t});\r\n\t\t});\r\n\t\t//console.log(10);\r\n\t}\r\n\r\n\tgetPopular() {\r\n\t\tfetch('/api', {\r\n\t\t\tmethod: 'POST',\r\n\t\t    headers: {\r\n\t\t      'Accept': 'application/json',\r\n\t\t      'Content-Type': 'application/json'\r\n\t\t    },\r\n\t\t    body: JSON.stringify({command: 'getPopular', since: 0})\r\n\t\t}).then(response => {\r\n\t\t\tresponse.json().then(body => {\r\n\t\t\t\tthis.setState({ goods: body.goods[0] });\r\n\t\t\t});\r\n\t\t});\r\n\t}\r\n\r\n\trender() {\r\n\t\t/*let rows = [];\r\n\t\tlet rowsGroups = [];\r\n\t\tlet j = 0;\r\n\t\tfor (let i = 0; i < this.state.goods.length; i++) {\r\n\t\t\trows.push(<Card name={this.state.goods[i].name} img={this.state.goods[i].photos} price={this.state.goods[i].price} createdAt={this.state.goods[i].created_at} />);\r\n\t\t\tj++;\r\n\t\t\tif (j == 3 || i == this.state.goods.length - 1) {\r\n\t\t\t\tj = 0;\r\n\t\t\t\trowsGroups.push(<div className=\"card-group\">{rows}</div>);\r\n\t\t\t\trows = [];\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn (\r\n\t\t\t<div>\r\n\t\t\t  {rowsGroups}\r\n\t\t\t</div>\r\n\t\t);*/\r\n\t\tconsole.log(this.state.goods);\r\n\t\tlet rows = [];\r\n\t\tfor (let i = 0; i < this.state.goods.length; i++)\r\n\t\t\trows.push(<Card id={this.state.goods[i].id} name={this.state.goods[i].name} img={this.state.goods[i].photos} price={this.state.goods[i].price} createdAt={this.state.goods[i].created_at} />);\r\n\t\treturn (\r\n\t\t\t<div>\r\n\t\t\t  {rows}\r\n\t\t\t</div>\r\n\t\t);\r\n\t}\r\n}\r\n\r\nclass Card extends React.Component {\r\n\tconstructor(props) {\r\n\t\tsuper(props);\r\n\t}\r\n\r\n\trender() {\r\n\t\tlet date = new Date(this.props.createdAt);\r\n\t\tlet dateStr = date.toLocaleString('ru', {\r\n\t        year: 'numeric',\r\n\t        month: 'long',\r\n\t        day: 'numeric',\r\n\t        hour: 'numeric',\r\n\t        minute: 'numeric'\r\n\t      });\r\n\t\tlet butImg = [];\r\n\t\tfor (let i = 0; i < this.props.img.length; i++) {\r\n\t\t\tif (i == 0)\r\n\t\t\t\tbutImg.push(<button type=\"button\" data-bs-target={\"#carouselGoodsIndicators\" + this.props.id} data-bs-slide-to={i} class=\"active\" aria-current=\"true\" aria-label={\"Slide \" + i}></button>);\r\n\t\t\telse\r\n\t\t\t\tbutImg.push(<button type=\"button\" data-bs-target={\"#carouselGoodsIndicators\" + this.props.id} data-bs-slide-to={i} aria-label={\"Slide \" + i}></button>);\r\n\t\t}\r\n\t\tlet img = [];\r\n\t\tfor (let i = 0; i < this.props.img.length; i++) {\r\n\t\t\tif (i == 0)\r\n\t\t\t\timg.push(<div className=\"carousel-item active\"><img className=\"d-block w-100\" src={\"goods_photos/\" + this.props.img[i]} alt={\"Slide \" + i}/></div>);\r\n\t\t\telse\r\n\t\t\t\timg.push(<div className=\"carousel-item\"><img className=\"d-block w-100\" src={\"goods_photos/\" + this.props.img[i]} alt={\"Slide \" + i}/></div>);\r\n\t\t}\r\n\t\treturn (<div class=\"col-xs-12 col-sm-12 col-md-8 col-lg-9 mb-3 mt-3\">\r\n\t\t\t\t\t<main id=\"goods-min\">\r\n\t\t\t\t\t\t<div className=\"col-xs-12 col-sm-12 col-md-4 col-lg-3\"  style={{float: 'left', height: '450px'}}>\r\n\t\t\t\t\t\t\t<div className=\"card m-1\">\r\n\t\t\t\t\t\t\t\t<div id={\"carouselGoodsIndicators\" + this.props.id} data-bs-interval=\"false\" className=\"carousel slide\" data-bs-ride=\"carousel\">\r\n\t\t\t\t\t\t\t\t<div className=\"carousel-indicators\">\r\n\t\t\t\t\t\t\t\t\t{butImg}\r\n\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t<div className=\"carousel-inner\">\r\n\t\t\t\t\t\t\t\t\t{img}\r\n\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t<button className=\"carousel-control-prev\" type=\"button\" data-bs-target={\"#carouselGoodsIndicators\" + this.props.id} data-bs-slide=\"prev\">\r\n\t\t\t\t\t\t\t\t\t<span className=\"carousel-control-prev-icon\" aria-hidden=\"true\"></span>\r\n\t\t\t\t\t\t\t\t\t<span className=\"visually-hidden\">Previous</span>\r\n\t\t\t\t\t\t\t\t</button>\r\n\t\t\t\t\t\t\t\t<button className=\"carousel-control-next\" type=\"button\" data-bs-target={\"#carouselGoodsIndicators\" + this.props.id} data-bs-slide=\"next\">\r\n\t\t\t\t\t\t\t\t\t<span className=\"carousel-control-next-icon\" aria-hidden=\"true\"></span>\r\n\t\t\t\t\t\t\t\t\t<span className=\"visually-hidden\">Next</span>\r\n\t\t\t\t\t\t\t\t</button>\r\n\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t<div className=\"card-body\">\r\n\t\t\t\t\t\t\t\t<a href={\"/goods/\" + this.props.id} target=\"_blank\" style={{color: \"black\"}}><h5 className=\"card-title\">{this.props.name.length > 45 ? this.props.name.substring(0, 45) + \"...\" : this.props.name}</h5></a>\r\n\t\t\t\t\t\t\t\t<p className=\"card-text\">{this.props.price + \"₽\"}</p>\r\n\t\t\t\t\t\t\t\t<p className=\"card-text\"><small className=\"text-muted\">{dateStr}</small></p>\r\n\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t</main>\r\n\t\t\t\t</div>\r\n\t\t);\r\n\t}\r\n}\r\n\r\n/*ReactDOM.render(\r\n  <GoodsMin />,\r\n  document.getElementById('goods-min')\r\n);\r\n\r\nclass Search extends React.Component {\r\n\tconstructor(props) {\r\n\t\tsuper(props);\r\n\t\tthis.getGoods = this.getGoods.bind(this);\r\n\t\tthis.getGoodsURL = this.getGoodsURL.bind(this);\r\n\t}\r\n\r\n\tcomponentDidMount() {\r\n        if (window.location.href.match(\"search=true\")) {\r\n        \tlet params = new URLSearchParams(new URL(window.location.href).search);\r\n\t\t\tlet query;\r\n\t\t\tlet sort;\r\n\t\t\tfor(let pair of params.entries()) {\r\n\t\t\t  if (pair[0] == 'query') {\r\n\t\t\t  \tquery = pair[1];\r\n\t\t\t  }\r\n\t\t\t  else if (pair[0] == 'sort') {\r\n\t\t\t  \tsort = pair[1];\r\n\t\t\t  }\r\n\t\t\t}\r\n        \tdocument.getElementById(\"search\").value = query;\r\n\t\t\tthis.getGoodsURL(query, 0, sort);\r\n\t\t}\r\n    }\r\n\r\n\tgetGoodsURL(query, since, sort) {\r\n\t\tfetch('/api', {\r\n\t\t\tmethod: 'POST',\r\n\t\t    headers: {\r\n\t\t      'Accept': 'application/json',\r\n\t\t      'Content-Type': 'application/json'\r\n\t\t    },\r\n\t\t    body: JSON.stringify({ command: 'searchGoods', word: query, since: since, sort: sort })\r\n\t\t}).then(response => {\r\n\t\t\tresponse.json().then(body => {\r\n\t\t\t\temitter.emit(\"CHANGE\", body.goods[0]);\r\n\t\t\t});\r\n\t\t});\r\n\t}*/\r\n\r\n\t/*getGoods(event) {\r\n\t\tfetch('/api', {\r\n\t\t\tmethod: 'POST',\r\n\t\t    headers: {\r\n\t\t      'Accept': 'application/json',\r\n\t\t      'Content-Type': 'application/json'\r\n\t\t    },\r\n\t\t    body: JSON.stringify({ command: 'searchGoods', word: document.getElementById(\"search\").value, since: 0 })\r\n\t\t}).then(response => {\r\n\t\t\tresponse.json().then(body => {\r\n\t\t\t\temitter.emit(\"CHANGE\", body.goods[0]);\r\n\t\t\t});\r\n\t\t});\r\n\t}*/\r\n\r\n\t/*getGoods(event) {\r\n\t\tconst url = new URL(window.location);\r\n\t\turl.searchParams.set('search', 'true');\r\n\t\turl.searchParams.set('query', document.getElementById(\"search\").value);\r\n\t\twindow.history.pushState({}, '', url);\r\n\t\twindow.location.reload();\r\n\t}\r\n\r\n\trender() {\r\n\t\treturn (\r\n\t\t\t<div style={{textAlign: 'center', marginBottom: '25px'}}>\r\n\t\t\t\t<input type=\"text\" class=\"form-control\" id=\"search\" style={{display: 'inline', width: '60vw', marginRight: '10px'}}/>\r\n\t\t\t\t<button type=\"button\" class=\"btn btn-primary\" onClick={this.getGoods} style={{display: 'inline'}}>Найти!</button>\r\n\t\t\t</div>\r\n\t\t);\r\n\t}\r\n}\r\n\r\nReactDOM.render(\r\n  <Search />,\r\n  document.getElementById('search-wrapper')\r\n);\r\n\r\nvar links = [\r\n  \"Новые\",\r\n  \"Подписки\",\r\n  \"Популярные\"\r\n];\r\n\r\nclass NavBar extends React.Component {\r\n  constructor(props) {\r\n    super(props);\r\n    this.output = this.output.bind(this);\r\n    let params = new URLSearchParams(new URL(window.location.href).search);\r\n\tlet sort;\r\n\tfor(let pair of params.entries()) {\r\n\t  if (pair[0] == 'sort') {\r\n\t  \tsort = pair[1];\r\n\t  }\r\n\t}\r\n\tif (!sort || sort == 'new') {\r\n\t\tvar active = [true];\r\n\t    for (var i = 1; i < links.length; i++) {\r\n\t      active.push(false);\r\n\t    }\r\n\t}\r\n\telse if (sort == 'popular') {\r\n\t\tvar active = [];\r\n\t    for (var i = 0; i < links.length; i++) {\r\n\t      active.push(false);\r\n\t    }\r\n\t    active[2] = true;\r\n\t}\r\n\tthis.state = {isActive: active};\r\n  }\r\n\r\n  output = num => {\r\n    var active = [];\r\n    for (var i = 0; i < links.length; i++) {\r\n      active.push(false);\r\n    }\r\n    active[num] = true;\r\n    this.setState({ isActive : active});\r\n  }\r\n\r\n  render() {\r\n    var rows = [];\r\n    for (var i = 0; i < links.length; i++) {\r\n      rows.push(<Nav isActive={this.state.isActive[i]} name={links[i]} func={this.output}/>);\r\n    }\r\n    return (\r\n      <span>\r\n        {rows}\r\n        <LogReg/>\r\n      </span>\r\n    );\r\n  }\r\n}\r\n\r\nclass Nav extends React.Component {\r\n  constructor(props) {\r\n    super(props);\r\n\r\n    // Эта привязка обязательна для работы `this` в колбэке.\r\n    this.handleClick = this.handleClick.bind(this);\r\n  }\r\n\r\n  handleClick() {\r\n    var num;\r\n    for (var i = 0; i < links.length; i++) {\r\n      if (this.props.name == links[i]) {\r\n        num = i;\r\n      }\r\n    }\r\n    this.props.func(num);\r\n    if (this.props.name == \"Популярные\") {\r\n      const url = new URL(window.location);\r\n\t  url.searchParams.set('sort', 'popular');\r\n\t  window.history.pushState({}, '', url);\r\n\t  window.location.reload();\r\n    }\r\n    else if (this.props.name == \"Новые\") {\r\n      const url = new URL(window.location);\r\n\t  url.searchParams.set('sort', 'new');\r\n\t  window.history.pushState({}, '', url);\r\n\t  window.location.reload();\r\n    }\r\n  }\r\n\r\n  render() {\r\n    var ariaCurrent = this.props.isActive ? \"page\" : null;\r\n    var className = 'nav-link';\r\n    if (this.props.isActive) {\r\n      className += ' active';\r\n    }\r\n    return (\r\n      <li className=\"nav-item d-block d-sm-block d-md-inline-block\"><a href=\"#\" className={className} aria-current={ariaCurrent} onClick={this.handleClick}>{this.props.name}</a></li>\r\n    );\r\n  }\r\n}\r\n\r\nclass LogReg extends React.Component {\r\n  constructor(props) {\r\n  \tsuper(props);\r\n  \tthis.state = {logout: false, confirm: null, nick: null};\r\n  }\r\n  componentDidMount() {\r\n  \tfetch('/api', {\r\n\t\t\tmethod: 'POST',\r\n\t\t    headers: {\r\n\t\t      'Accept': 'application/json',\r\n\t\t      'Content-Type': 'application/json'\r\n\t\t    },\r\n\t\t    body: JSON.stringify({ command: 'isLoggedIn' })\r\n\t\t}).then(response => {\r\n\t\t\tresponse.json().then(body => {\r\n\t\t\t\tthis.setState({logout: body.logout, confirm: body.confirm, nick: body.nick});\r\n\t\t\t});\r\n\t\t});\r\n  }\r\n  render() {\r\n  \tconsole.log(this.state);\r\n  \tif (!this.state.logout) {\r\n  \t  return (\r\n\t    <li className=\"nav-item d-block d-sm-block d-md-inline-block px-3\"><a href=\"/logreg\" className=\"nav-link\" id=\"logreg\">Вход/Регистрация</a></li>\r\n\t  );\r\n  \t}\r\n    else {\r\n      return (\r\n      \t<div className=\"dropdown d-block d-sm-block d-md-inline-block px-3\">\r\n          <button className=\"btn btn-primary dropdown-toggle\" type=\"button\" id=\"dropdownMenuButton\" data-bs-toggle=\"dropdown\" aria-expanded=\"false\">\r\n            {this.state.nick} {this.state.confirm ? \"(осуществлен вход)\" : \"(требуется подтверждение почты)\"}\r\n          </button>\r\n          <ul className=\"dropdown-menu\" aria-labelledby=\"dropdownMenuButton\">\r\n            {this.state.confirm ? <li><a className=\"dropdown-item\" href=\"/goods/create\">Продать</a></li> : ''}\r\n            {this.state.confirm ? <li><a className=\"dropdown-item\" href=\"#\">Создано</a></li> : ''}\r\n            <li><a className=\"dropdown-item\" href=\"#\">Настройки</a></li>\r\n            <li><a className=\"dropdown-item\" href=\"/logout\">Выйти</a></li>\r\n          </ul>\r\n        </div>\r\n      );\r\n    }\r\n  }\r\n}\r\n\r\nReactDOM.render(\r\n  <NavBar />,\r\n  document.getElementById('nav')\r\n);*/"],"names":["React","GoodsMin","props","state","goods","getNew","bind","getPopular","window","location","href","match","subscriptionChangeState","emitter","subscribe","setState","fetch","method","headers","body","JSON","stringify","command","since","then","response","json","console","log","rows","i","length","push","id","name","photos","price","created_at","Component","Card","date","Date","createdAt","dateStr","toLocaleString","year","month","day","hour","minute","butImg","img","height","color","substring"],"sourceRoot":""}